pipeline{
	agent any
	environment{
		ANSIBLE_CONFIG="${WORKSPACE}/deploy/.ansible.cfg"
	}	
	

	stages{
		stage('Clean Up'){
			steps{
				cleanWs()
			}

	    }

	    stage('SCM Checkout'){
			steps{
				git branch: 'main', url: 'https://github.com/realayo/ansible-config-mgt'
			}

	    }   

	    stage('Execute Ansible'){
		    steps{
			    ansiblePlaybook credentialsId: 'private-key', installation: 'ansible', inventory: 'inventory/dev.yml', playbook: 'playbooks/site.yml'
		    }

	    // }
        // stage('ec2-user'){
        //     steps{
        //         ansiblePlaybook credentialsId: 'private-pem', disableHostKeyChecking: true, installation: 'ansible', inventory: 'inventory/dev.yml', limit: 'db', playbook: 'playbooks/site.yml'
        //     }
        // }
        // stage('Execute Ansible-Redhat'){
		//     steps{
		// 	    ansiblePlaybook credentialsId: 'private-key1', disableHostKeyChecking: true, installation: 'ansible', inventory: 'inventory/dev.yml', playbook: 'playbooks/site.yml'
		//     }

	    // }
	
    }
}